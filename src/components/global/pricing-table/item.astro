---
import Button from "../../shared/Button.astro";

// Define TypeScript interfaces
interface Feature {
  item: string;
  active_feature: boolean;
}

interface Button {
  link: string;
  text: string;
}

interface PricingTier {
  tier: string;
  highlight_tier: boolean;
  description: string;
  currency_symbol: string;
  price: number;
  has_discount: boolean;
  discount_price?: number;
  features: Feature[];
  button?: Button;
}

interface Props {
  tier: PricingTier;
}

const { tier } = Astro.props;
---

<div class="w-full lg:w-1/3 px-4" data-editable="array-item">
  <div class={`bg-white rounded-xl shadow-lg border transition-all duration-300 ease-in-out p-8 xl:p-10 mb-8 lg:mb-14 ${
    tier.highlight_tier 
      ? "border-primary lg:-mt-10" 
      : "border-white"
  }`}>
    
    <!-- Card Header -->
    <h5 class={`text-2xl xl:text-3xl font-bold leading-tight mb-2 pl-4 xl:pl-6 transition-all duration-300 ${
      tier.highlight_tier 
        ? "text-primary" 
        : "text-gray-900"
    }`}>
      <editable-text data-prop="tier">{tier.tier}</editable-text>
    </h5>
    
    <p class="text-lg xl:text-xl leading-relaxed mb-6 pl-4 xl:pl-6 text-gray-600 font-medium tracking-tight">
      <editable-text data-prop="description">{tier.description}</editable-text>
    </p>

    <!-- Pricing Section -->
    <div class="relative mb-8 flex items-center text-black border-t border-b border-red-100 py-4">
      {tier.has_discount ? (
        <>
          <!-- Discount Price Display -->
          <p class="text-4xl xl:text-5xl font-bold pl-4 xl:pl-6 mb-0 mr-4 z-10">
            <editable-text data-prop="currency_symbol">{tier.currency_symbol}</editable-text>{tier.discount_price}
          </p>
          
          <!-- Original Price with Strikethrough -->
          <div class="relative flex items-center">
            <p class="text-2xl font-semibold text-gray-500 mb-0 relative z-10">
              <editable-text data-prop="currency_symbol">{tier.currency_symbol}</editable-text>{tier.price}
            </p>
            <!-- Strikethrough Vector -->
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20">
              <img
                src="/images/pricing/Vector1.svg"
                alt="Strikethrough"
                loading="lazy"
                class="w-auto h-auto"
              />
            </div>
          </div>
          
          <!-- Background Shape for Discount -->
          <div 
            class="absolute top-2 left-[10%] w-[35%] h-full -z-10 bg-[#faaa8f] mask-[url(/images/pricing/shape-two.png)] [-webkit-mask-image:url(/images/pricing/shape-two.png)] mask-no-repeat [-webkit-mask-repeat:no-repeat]"
          />
        </>
      ) : (
        <>
          <!-- Regular Price Display -->
          <p class="text-4xl xl:text-5xl font-bold pl-4 xl:pl-6 mb-0 z-10">
            <span>
              <editable-text data-prop="currency_symbol">{tier.currency_symbol}</editable-text>{tier.price}
            </span>
          </p>
          
          <!-- Background Shape for Regular -->
          <div 
            class="absolute top-2 left-[10%] w-[35%] h-full -z-10 bg-[#faaa8f] mask-[url(/images/pricing/shape-one.png)] [-webkit-mask-image:url(/images/pricing/shape-one.png)] mask-no-repeat [-webkit-mask-repeat:no-repeat]"
          />
        </>
      )}
    </div>

    <!-- Features List -->
    <div class="px-4 xl:px-6">
      <ul class="space-y-6 mb-12" data-editable="array" data-prop="features">
        <template>
           <li 
            data-editable="array-item"
            class={`flex items-center text-lg xl:text-xl leading-relaxed font-bold tracking-tight ${
              feature.active_feature 
                ? "text-gray-600" 
                : "text-gray-400"
            }`}
          >
            <i 
              class={`ph-check mr-4 xl:mr-5 ${
                feature.active_feature 
                  ? "text-primary" 
                  : "text-gray-400"
              }`}
            />
            <editable-text data-prop="item">{feature.item}</editable-text>
          </li>
        </template>
        {tier.features?.length && tier.features?.map((feature) => (
          <li 
            data-editable="array-item"
            class={`flex items-center text-lg xl:text-xl leading-relaxed font-bold tracking-tight ${
              feature.active_feature 
                ? "text-gray-600" 
                : "text-gray-400"
            }`}
          >
            <i 
              class={`ph-check mr-4 xl:mr-5 ${
                feature.active_feature 
                  ? "text-primary" 
                  : "text-gray-400"
              }`}
            />
            <editable-text data-prop="item">{feature.item}</editable-text>
          </li>
        ))}
      </ul>
      
      <!-- Action Button -->
      <div class="text-center">
        {tier.button && (
          <Button 
            href={tier.button.link}
            variant={tier.highlight_tier ? "primary" : "secondary"}
            size="lg"
            text={tier.button.text}
            data-prop="button.text"
            data-editable="text"
          />
        )}
      </div>
    </div>
  </div>
</div>